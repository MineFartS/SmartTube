<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    package="com.liskovsoft.smartyoutubetv2.tv">

    <!-- Shield on Android 11 speech recognizer not working fix? -->
    <!-- https://stackoverflow.com/questions/64319117/speechrecognizer-not-available-when-targeting-android-11 -->
    <queries>
        <intent>
            <action android:name="android.speech.RecognitionService" />
        </intent>
    </queries>

    <permission
        android:name="${applicationId}.ACCESS_VIDEO_DATA"
        android:protectionLevel="signature" />

    <uses-permission android:name="${applicationId}.ACCESS_VIDEO_DATA" />
    <uses-permission android:name="android.permission.INTERNET" />
    <uses-permission android:name="android.permission.RECORD_AUDIO" />

    <!-- NOTE: use older api -->
    <uses-sdk tools:overrideLibrary="
        androidx.leanback.preference,
        androidx.recommendation,
        org.xwalk.core,
        com.algolia.instantsearch.voice,
        androidx.leanback, androidx.tvprovider,
        com.github.rubensousa.previewseekbar,
        com.github.rubensousa.previewseekbar.exoplayer,
        com.google.android.exoplayer2.ext.leanback,
        com.google.android.exoplayer2.ext.vp9,
        com.google.android.exoplayer2.testutil,
        com.google.android.exoplayer2.ext.okhttp,
        com.google.firebase.crashlytics,
        com.google.firebase.iid,
        io.nn.alpha" />


    <uses-feature
        android:name="android.hardware.microphone"
        android:required="false" />

    <uses-feature
        android:name="android.hardware.touchscreen"
        android:required="false" />

    <uses-feature
        android:name="android.software.leanback"
        android:required="true" />

    <!-- android:usesCleartextTraffic - allow HTTP traffic -->
    <!-- Alt cleartext options: https://stackoverflow.com/questions/45940861/android-8-cleartext-http-traffic-not-permitted -->
    <application
        android:name="com.liskovsoft.smartyoutubetv2.tv.ui.main.MainApplication"
        android:allowBackup="false"
        android:banner="@mipmap/app_banner"
        android:hardwareAccelerated="true"
        android:icon="@mipmap/app_icon"
        android:label="@string/app_name"
        android:largeHeap="true"
        android:logo="@mipmap/app_logo"
        android:theme="@style/App.Theme.Leanback.Browse"
        android:usesCleartextTraffic="true"
        tools:ignore="GoogleAppIndexingWarning,LockedOrientationActivity,UnusedAttribute"
        tools:node="merge"
        tools:replace="android:theme,android:allowBackup">

        <!-- Screen Mirror (e.g. DIAL) for Amazon TV -->
        <!-- Not implemented yet( -->
        <!--<meta-data android:name="whisperplay" android:resource="@xml/whisperplay"/>-->

        <!-- This activity's name used inside atv channels -->
        <!-- More info: com.liskovsoft.leanbackassistant.utils.AppUtil -->
        <activity
            android:name="com.liskovsoft.smartyoutubetv2.tv.ui.main.SplashActivity"
            android:configChanges="screenSize|smallestScreenSize|screenLayout|orientation|layoutDirection"
            android:exported="true"
            android:launchMode="singleInstance"
            android:screenOrientation="unspecified">

            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.DEFAULT" />
                <category android:name="android.intent.category.LAUNCHER" />
                <category android:name="android.intent.category.LEANBACK_LAUNCHER" />
            </intent-filter>

            <!-- Process intents from other apps -->
            <intent-filter>
                <action android:name="android.intent.action.VIEW" />
                <action android:name="android.media.action.MEDIA_PLAY_FROM_SEARCH" />
                <action android:name="android.nfc.action.NDEF_DISCOVERED" />

                <category android:name="android.intent.category.DEFAULT" />
                <category android:name="android.intent.category.BROWSABLE" />

                <data android:scheme="http" />
                <data android:scheme="https" />
                <data android:host="youtube.com" />
                <data android:host="www.youtube.com" />
                <data android:host="m.youtube.com" />
                <data android:host="youtu.be" />
                <data android:pathPattern=".*" />
                <data
                    android:host="search"
                    android:scheme="youtube" />
                <data
                    android:host="play"
                    android:scheme="youtube" />
            </intent-filter>

            <intent-filter>
                <action android:name="android.intent.action.VIEW" />
                <action android:name="android.media.action.MEDIA_PLAY_FROM_SEARCH" />
                <action android:name="android.nfc.action.NDEF_DISCOVERED" />

                <category android:name="android.intent.category.DEFAULT" />
                <category android:name="android.intent.category.BROWSABLE" />

                <data android:scheme="vnd.youtube" />
                <data android:scheme="vnd.youtube.launch" />
            </intent-filter>

            <intent-filter>
                <action android:name="android.intent.action.SEND" />
                <category android:name="android.intent.category.DEFAULT" />
                <data android:mimeType="text/plain" />
            </intent-filter>

        </activity>

        <!-- Alt app launcher icon -->
        <activity-alias
            android:name="com.liskovsoft.smartyoutubetv2.tv.ui.main.SplashActivityAlt"
            android:enabled="false"
            android:exported="true"
            android:icon="@mipmap/app_icon_alt"
            android:label="@string/app_name"
            android:targetActivity="com.liskovsoft.smartyoutubetv2.tv.ui.main.SplashActivity">

            <intent-filter>
                <category android:name="android.intent.category.DEFAULT" />
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
                <category android:name="android.intent.category.LEANBACK_LAUNCHER" />
            </intent-filter>

        </activity-alias>

        <!-- noHistory is essential for dialogs. Because otherwise you'll see previous dialog content when opening. -->
        <!-- behind is important too. This fix crashes on Android 8 (api 26) and above. -->
        <!-- More info about behind: https://stackoverflow.com/a/52426009/1279056 -->
        <activity
            android:name="com.liskovsoft.smartyoutubetv2.tv.ui.dialogs.AppDialogActivity"
            android:configChanges="screenSize|smallestScreenSize|screenLayout|orientation|layoutDirection"
            android:excludeFromRecents="true"
            android:launchMode="singleInstance"
            android:noHistory="true"
            android:screenOrientation="behind"
            android:theme="@style/App.Theme.Leanback.Preferences" />

        <activity
            android:name="com.liskovsoft.smartyoutubetv2.tv.ui.browse.BrowseActivity"
            android:configChanges="screenSize|smallestScreenSize|screenLayout|orientation|layoutDirection"
            android:launchMode="singleInstance"
            android:screenOrientation="unspecified" />

        <activity
            android:name="com.liskovsoft.smartyoutubetv2.tv.ui.channel.ChannelActivity"
            android:configChanges="screenSize|smallestScreenSize|screenLayout|orientation|layoutDirection"
            android:launchMode="singleInstance"
            android:screenOrientation="unspecified" />

        <activity
            android:name="com.liskovsoft.smartyoutubetv2.tv.ui.channeluploads.ChannelUploadsActivity"
            android:configChanges="screenSize|smallestScreenSize|screenLayout|orientation|layoutDirection"
            android:launchMode="singleInstance"
            android:screenOrientation="unspecified" />

        <!-- Remove to fix Sony wake up bug? android:turnScreenOn="true" -->

        <activity
            android:name="com.liskovsoft.smartyoutubetv2.tv.ui.playback.PlaybackActivity"
            android:configChanges="screenSize|smallestScreenSize|screenLayout|orientation|layoutDirection"
            android:launchMode="singleInstance"
            android:resizeableActivity="true"
            android:screenOrientation="unspecified"
            android:showWhenLocked="true"
            android:supportsPictureInPicture="true"
            android:theme="@style/App.Theme.Leanback.Player" />

        <activity
            android:name="com.liskovsoft.smartyoutubetv2.tv.ui.search.tags.SearchTagsActivity"
            android:configChanges="screenSize|smallestScreenSize|screenLayout|orientation|layoutDirection"
            android:launchMode="singleInstance"
            android:screenOrientation="unspecified" />

        <activity
            android:name="com.liskovsoft.smartyoutubetv2.tv.ui.signin.SignInActivity"
            android:configChanges="screenSize|smallestScreenSize|screenLayout|orientation|layoutDirection"
            android:launchMode="singleInstance"
            android:screenOrientation="unspecified"
            android:theme="@style/App.Theme.Leanback.GuidedStep" />

        <activity
            android:name="com.liskovsoft.smartyoutubetv2.tv.ui.adddevice.AddDeviceActivity"
            android:configChanges="screenSize|smallestScreenSize|screenLayout|orientation|layoutDirection"
            android:launchMode="singleInstance"
            android:screenOrientation="unspecified"
            android:theme="@style/App.Theme.Leanback.GuidedStep" />

        <activity
            android:name="com.liskovsoft.smartyoutubetv2.tv.ui.webbrowser.WebBrowserActivity"
            android:configChanges="screenSize|smallestScreenSize|screenLayout|orientation|layoutDirection"
            android:launchMode="singleInstance"
            android:screenOrientation="unspecified" />

        <!-- BEGIN Launchers (used inside tvQuickActions. Don't rename them or move!) -->

        <activity
            android:name="com.liskovsoft.smartyoutubetv2.tv.launchers.HomeLauncherActivity"
            android:configChanges="screenSize|smallestScreenSize|screenLayout|orientation|layoutDirection"
            android:exported="true"
            android:icon="@drawable/icon_home"
            android:label="@string/header_home"
            android:launchMode="singleInstance"
            android:logo="@drawable/icon_home"
            android:screenOrientation="unspecified" />

        <activity
            android:name="com.liskovsoft.smartyoutubetv2.tv.launchers.NewsLauncherActivity"
            android:configChanges="screenSize|smallestScreenSize|screenLayout|orientation|layoutDirection"
            android:exported="true"
            android:icon="@drawable/icon_news"
            android:label="@string/header_news"
            android:launchMode="singleInstance"
            android:logo="@drawable/icon_news"
            android:screenOrientation="unspecified" />

        <activity
            android:name="com.liskovsoft.smartyoutubetv2.tv.launchers.MusicLauncherActivity"
            android:configChanges="screenSize|smallestScreenSize|screenLayout|orientation|layoutDirection"
            android:exported="true"
            android:icon="@drawable/icon_music"
            android:label="@string/header_music"
            android:launchMode="singleInstance"
            android:logo="@drawable/icon_music"
            android:screenOrientation="unspecified" />

        <activity
            android:name="com.liskovsoft.smartyoutubetv2.tv.launchers.GamesLauncherActivity"
            android:configChanges="screenSize|smallestScreenSize|screenLayout|orientation|layoutDirection"
            android:exported="true"
            android:icon="@drawable/icon_gaming"
            android:label="@string/header_gaming"
            android:launchMode="singleInstance"
            android:logo="@drawable/icon_gaming"
            android:screenOrientation="unspecified" />

        <activity
            android:name="com.liskovsoft.smartyoutubetv2.tv.launchers.ChannelsLauncherActivity"
            android:configChanges="screenSize|smallestScreenSize|screenLayout|orientation|layoutDirection"
            android:exported="true"
            android:icon="@drawable/icon_channels"
            android:label="@string/header_channels"
            android:launchMode="singleInstance"
            android:logo="@drawable/icon_channels"
            android:screenOrientation="unspecified" />

        <activity
            android:name="com.liskovsoft.smartyoutubetv2.tv.launchers.SubscriptionsLauncherActivity"
            android:configChanges="screenSize|smallestScreenSize|screenLayout|orientation|layoutDirection"
            android:exported="true"
            android:icon="@drawable/icon_subscriptions"
            android:label="@string/header_subscriptions"
            android:launchMode="singleInstance"
            android:logo="@drawable/icon_subscriptions"
            android:screenOrientation="unspecified" />

        <activity
            android:name="com.liskovsoft.smartyoutubetv2.tv.launchers.HistoryLauncherActivity"
            android:configChanges="screenSize|smallestScreenSize|screenLayout|orientation|layoutDirection"
            android:exported="true"
            android:icon="@drawable/icon_history"
            android:label="@string/header_history"
            android:launchMode="singleInstance"
            android:logo="@drawable/icon_history"
            android:screenOrientation="unspecified" />

        <activity
            android:name="com.liskovsoft.smartyoutubetv2.tv.launchers.PlaylistsLauncherActivity"
            android:configChanges="screenSize|smallestScreenSize|screenLayout|orientation|layoutDirection"
            android:exported="true"
            android:icon="@drawable/icon_playlist"
            android:label="@string/header_playlists"
            android:launchMode="singleInstance"
            android:logo="@drawable/icon_playlist"
            android:screenOrientation="unspecified" />

        <activity
            android:name="com.liskovsoft.smartyoutubetv2.tv.launchers.SearchLauncherActivity"
            android:configChanges="screenSize|smallestScreenSize|screenLayout|orientation|layoutDirection"
            android:exported="true"
            android:icon="@drawable/action_search"
            android:label="@string/action_search"
            android:launchMode="singleInstance"
            android:logo="@drawable/action_search"
            android:screenOrientation="unspecified" />

        <!-- END Launchers -->
    </application>

</manifest>